[buildout]
parts +=
    zeoserver
    client1
mountpoint = ${buildout:projectid}

[zeoserver]
recipe = plone.recipe.zeoserver
zeo-address = 8100
blob-storage = ${buildout:directory}/var/blobstorage
zeo-conf-additional =
    <filestorage ${buildout:projectid}>
        path ${buildout:directory}/var/filestorage/${buildout:projectid}.fs
        blob-dir ${buildout:directory}/var/blobstorage-${buildout:projectid}
    </filestorage>

[instance]
zeo-client = True
zeo-address = ${zeoserver:zeo-address}
shared-blob = on
blob-storage =  ${buildout:directory}/var/blobstorage-${buildout:projectid}
zope-conf-additional +=
    <zodb_db ${buildout:projectid}>
        mount-point /${buildout:mountpoint}
        <zeoclient>
            server ${instance:zeo-address}
            storage ${buildout:projectid}
            name ${buildout:projectid}_zeostorage
            blob-dir ${buildout:directory}/var/blobstorage-${buildout:projectid}
            shared-blob-dir on
        </zeoclient>
    </zodb_db>

[client1]
recipe = plone.recipe.zope2instance
http-address = 8081
blob-storage = ${instance:blob-storage}
shared-blob = on
zeo-client = True
zeo-address = ${zeoserver:zeo-address}
environment-vars = ${instance:environment-vars}
eggs = ${instance:eggs}
zope-conf-additional = ${instance:zope-conf-additional}
